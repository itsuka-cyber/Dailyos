<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>// daily.log</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="terminal">
    <header class="terminal-header">
      <div class="dots">
        <span class="dot red"></span>
        <span class="dot yellow"></span>
        <span class="dot green"></span>
      </div>
      <div class="title">~/life/daily-log.md</div>
      <nav class="toolbar">
        <a href="index.html" class="toolbar-link">// Home</a>
        <a href="admin.html" class="toolbar-link">// Admin</a>
        <a href="about.html" class="toolbar-link">// About</a>
        <a href="privasi.html" class="toolbar-link">// Privasi</a>
      </nav>
      <button id="themeToggle">theme()</button>
    </header>
    <main class="terminal-body">
      <section class="welcome-section">
        <h1>ðŸ‘‹ Selamat Datang di <span style="color:var(--accent-2)">daily.log</span></h1>
        <p>
          Catatan harian, perjalanan hidup, dan dokumentasi belajar
          dengan gaya <span style="color:var(--accent)">terminal coding</span> masa kini.<br>
          Cari perjalanan, inspirasi, atau langsung mulai nulis di menu <b>Admin</b>.
        </p>
      </section>
      <form id="searchForm">
        <input type="search" id="searchInput" placeholder="Cari catatan..." autocomplete="off" />
      </form>
      <pre class="comment">
/**
 * personal daily notes
 * author: Riadhus Sholihin
 * repo : github.com/itsuka-cyber/daily-log
 */
      </pre>
      <!-- Catatan akan muncul otomatis di sini -->
      <a href="admin.html" class="admin-link">// go to admin panel â†’</a>
    </main>
    <footer class="terminal-footer">
      <span>Â© <span id="year"></span> daily.log | deployed on Netlify</span>
    </footer>
  </div>
  <script>
    // Toggle tema dark/light
    const root = document.documentElement;
    const toggle = document.getElementById("themeToggle");
    const yearSpan = document.getElementById("year");
    if (yearSpan) { yearSpan.textContent = new Date().getFullYear(); }
    const savedTheme = localStorage.getItem("theme");
    if (savedTheme === "light") { root.setAttribute("data-theme", "light"); }
    if (toggle) {
      toggle.addEventListener("click", () => {
        const isLight = root.getAttribute("data-theme") === "light";
        if (isLight) { root.removeAttribute("data-theme"); localStorage.setItem("theme", "dark"); }
        else { root.setAttribute("data-theme", "light"); localStorage.setItem("theme", "light"); }
      });
    }

    // Menampilkan catatan harian + file
    function loadNotes(q = "") {
      const container = document.querySelector('.terminal-body');
      const notes = JSON.parse(localStorage.getItem('dailyNotes') || '[]');
      container.querySelectorAll('.entry').forEach(e => e.remove());
      let filtered = notes;
      if (q && q.trim().length > 0) {
        filtered = notes.filter(note =>
          note.title.toLowerCase().includes(q) ||
          note.content.toLowerCase().includes(q) ||
          note.tags.some(t => t.toLowerCase().includes(q))
        );
      }
      if (filtered.length === 0) {
        container.innerHTML += `<div class="entry"><p>Tidak ada catatan harian${q ? ' untuk pencarian tersebut' : ''}. Silakan tambah di admin.</p></div>`;
        return;
      }
      filtered.slice().reverse().forEach(note => {
        let html = `
        <section class="entry">
          <div class="meta">
            <span class="tag">@${note.date}</span>
            ${note.tags.map(t => `<span class="tag">#${t}</span>`).join('')}
          </div>
          <h2>commit: "${note.title}"</h2>
          <p>${note.content}</p>
        `;
        if (note.files && note.files.length) {
          note.files.forEach(file => {
            if (file.type.startsWith('image/')) {
              html += `<img src="${file.data}" alt="${file.name}" />`;
            } else if (file.type.startsWith('video/')) {
              html += `<video controls><source src="${file.data}" type="${file.type}"></video>`;
            } else {
              html += `<a href="${file.data}" download="${file.name}" style="color:var(--accent-2);">${file.name}</a>`;
            }
          });
        }
        html += `</section>`;
        container.innerHTML += html;
      });
    }
    document.addEventListener('DOMContentLoaded', () => loadNotes());

    // Search fitur
    document.getElementById('searchForm').onsubmit = function(e) {
      e.preventDefault();
      const q = document.getElementById('searchInput').value.toLowerCase();
      loadNotes(q);
    };
  </script>
</body>
</html>
